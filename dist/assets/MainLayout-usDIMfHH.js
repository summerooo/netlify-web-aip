import{y as P,r as z,c,h as E,z as S,A as V,R as e,J as t,al as a,B as s,P as I,u as r,O as _,aB as L}from"./vendor-D5A_PLSQ.js";import{a as O,h as R,o as $,f as j,b as q,d as D,E as v}from"./ui-DUo8Dfqk.js";import{u as J,s as T}from"./index-1yu-MD6X.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./supabase-C1h6x9Gt.js";const F={class:"main-layout"},G={class:"header-right"},H={class:"user-dropdown"},K={class:"username"},Q=P({__name:"MainLayout",setup(W){const m=L(),u=J(),f=z({}),w=c(()=>{var n;return`https://api.dicebear.com/7.x/initials/svg?seed=${(n=u.user)==null?void 0:n.email}`}),g=c(()=>{var n;return f.value.full_name||((n=u.user)==null?void 0:n.email)||"用户"}),b=async()=>{if(u.user)try{const{data:n,error:o}=await T.from("user_profiles").select("full_name").eq("id",u.user.id).single();n&&(f.value=n)}catch(n){console.error("获取用户资料失败:",n)}},x=async n=>{switch(n){case"profile":m.push("/profile");break;case"settings":v.info("设置功能开发中");break;case"logout":await u.signOut(),v.success("已退出登录"),m.push("/login");break}};return E(()=>{b()}),(n,o)=>{const h=a("el-avatar"),l=a("el-icon"),i=a("el-dropdown-item"),y=a("el-dropdown-menu"),k=a("el-dropdown"),B=a("el-header"),d=a("el-menu-item"),C=a("el-menu"),A=a("el-aside"),M=a("router-view"),N=a("el-main"),p=a("el-container");return V(),S("div",F,[e(p,null,{default:t(()=>[e(B,{class:"header"},{default:t(()=>[o[3]||(o[3]=s("div",{class:"header-left"},[s("h1",null,"AIP 项目管理平台")],-1)),s("div",G,[e(k,{onCommand:x},{dropdown:t(()=>[e(y,null,{default:t(()=>[e(i,{command:"profile"},{default:t(()=>[...o[0]||(o[0]=[_("个人资料",-1)])]),_:1}),e(i,{command:"settings"},{default:t(()=>[...o[1]||(o[1]=[_("设置",-1)])]),_:1}),e(i,{divided:"",command:"logout"},{default:t(()=>[...o[2]||(o[2]=[_("退出登录",-1)])]),_:1})]),_:1})]),default:t(()=>[s("span",H,[e(h,{size:32,src:w.value},null,8,["src"]),s("span",K,I(g.value),1),e(l,null,{default:t(()=>[e(r(O))]),_:1})])]),_:1})])]),_:1}),e(p,null,{default:t(()=>[e(A,{width:"250px",class:"sidebar"},{default:t(()=>[e(C,{"default-active":n.$route.path,router:"",class:"sidebar-menu"},{default:t(()=>[e(d,{index:"/dashboard"},{default:t(()=>[e(l,null,{default:t(()=>[e(r(R))]),_:1}),o[4]||(o[4]=s("span",null,"工作台",-1))]),_:1}),e(d,{index:"/organizations"},{default:t(()=>[e(l,null,{default:t(()=>[e(r($))]),_:1}),o[5]||(o[5]=s("span",null,"组织管理",-1))]),_:1}),e(d,{index:"/projects"},{default:t(()=>[e(l,null,{default:t(()=>[e(r(j))]),_:1}),o[6]||(o[6]=s("span",null,"项目管理",-1))]),_:1}),e(d,{index:"/tasks"},{default:t(()=>[e(l,null,{default:t(()=>[e(r(q))]),_:1}),o[7]||(o[7]=s("span",null,"任务管理",-1))]),_:1}),e(d,{index:"/knowledge"},{default:t(()=>[e(l,null,{default:t(()=>[e(r(D))]),_:1}),o[8]||(o[8]=s("span",null,"知识库",-1))]),_:1})]),_:1},8,["default-active"])]),_:1}),e(N,{class:"main-content"},{default:t(()=>[e(M)]),_:1})]),_:1})]),_:1})])}}}),oe=U(Q,[["__scopeId","data-v-931cedfb"]]);export{oe as default};
