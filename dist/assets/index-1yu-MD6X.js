const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-BLi6jRR6.js","assets/vendor-D5A_PLSQ.js","assets/ui-DUo8Dfqk.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/supabase-C1h6x9Gt.js","assets/Login-ndnfnd0c.css","assets/Register-BmLk_Ba8.js","assets/Register-B2gcgvnE.css","assets/MainLayout-usDIMfHH.js","assets/MainLayout-BgbWduCP.css","assets/Dashboard-BJE8P4Vo.js","assets/Dashboard-BfGO81mE.css","assets/Organizations-DCYviPPX.js","assets/organizations-DV3rHeUx.js","assets/Organizations-B1gr1-YO.css","assets/OrganizationDetail-CsXwprKX.js","assets/projects-C6oOc8Q2.js","assets/OrganizationDetail-DGZ7KSSU.css","assets/Projects-Dz58Xe6b.js","assets/Projects-B8gl3Lbc.css","assets/Tasks-D59GKoh6.js","assets/Tasks-CWa48-wd.css","assets/ProjectDetail-CFvfz42m.js","assets/ProjectDetail-DPKwOrHH.css","assets/AcceptInvitation-DK0dCCUz.js","assets/AcceptInvitation-G73EQuRE.css","assets/AcceptOrganizationInvitation-DuvaM_yT.js","assets/AcceptOrganizationInvitation-DmwlDAZA.css","assets/Profile-BUuvU0yd.js","assets/Profile-CpLb_d2m.css"])))=>i.map(i=>d[i]);
import{ax as h,r as d,y as g,h as v,z as A,A as y,R as E,al as O,ay as P,az as I,au as w,aA as L}from"./vendor-D5A_PLSQ.js";import{c as R,_ as i}from"./supabase-C1h6x9Gt.js";import{i as b}from"./ui-DUo8Dfqk.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))n(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const p of o.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&n(p)}).observe(document,{childList:!0,subtree:!0});function a(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(e){if(e.ep)return;e.ep=!0;const o=a(e);fetch(e.href,o)}})();const z="https://spradrghqzoljgiglwil.supabase.co",D="sb_publishable_V2Wod6TRwJ6kBGcNgfeA5A_D8pNVZjd",c=R(z,D);async function S(t,r,a){const{data:n,error:e}=await c.auth.signUp({email:t,password:r,options:{data:{full_name:a}}});if(e)throw e;if(n.user&&a){const{error:o}=await c.from("user_profiles").insert({id:n.user.id,email:t,full_name:a});o&&console.error("创建用户资料失败:",o)}return n}async function V(t,r){const{data:a,error:n}=await c.auth.signInWithPassword({email:t,password:r});if(n)throw n;return a}async function T(){const{error:t}=await c.auth.signOut();if(t)throw t}async function j(){const{data:{session:t}}=await c.auth.getSession();return t}function q(t){return c.auth.onAuthStateChange(t)}const m=h("auth",()=>{const t=d(null),r=d(!1),a=d(!1);return{user:t,loading:r,initialized:a,initializeAuth:async()=>{if(!a.value)try{const s=await j();t.value=(s==null?void 0:s.user)??null,q((l,u)=>{t.value=(u==null?void 0:u.user)??null}),a.value=!0}catch(s){console.error("Auth initialization failed:",s),a.value=!0}},signUp:async(s,l,u)=>{r.value=!0;try{return await S(s,l,u)}finally{r.value=!1}},signIn:async(s,l)=>{r.value=!0;try{return await V(s,l)}finally{r.value=!1}},signOut:async()=>{r.value=!0;try{await T()}finally{r.value=!1}}}}),U={id:"app"},C=g({__name:"App",setup(t){const r=m();return v(()=>{r.initializeAuth()}),(a,n)=>{const e=O("router-view");return y(),A("div",U,[E(e)])}}}),f=P({history:I(),routes:[{path:"/",redirect:"/dashboard"},{path:"/login",name:"Login",component:()=>i(()=>import("./Login-BLi6jRR6.js"),__vite__mapDeps([0,1,2,3,4,5]))},{path:"/register",name:"Register",component:()=>i(()=>import("./Register-BmLk_Ba8.js"),__vite__mapDeps([6,1,2,3,4,7]))},{path:"/",component:()=>i(()=>import("./MainLayout-usDIMfHH.js"),__vite__mapDeps([8,1,2,3,4,9])),meta:{requiresAuth:!0},children:[{path:"dashboard",name:"Dashboard",component:()=>i(()=>import("./Dashboard-BJE8P4Vo.js"),__vite__mapDeps([10,1,2,3,4,11]))},{path:"organizations",name:"Organizations",component:()=>i(()=>import("./Organizations-DCYviPPX.js"),__vite__mapDeps([12,1,2,13,3,4,14]))},{path:"organizations/:id",name:"OrganizationDetail",component:()=>i(()=>import("./OrganizationDetail-CsXwprKX.js"),__vite__mapDeps([15,1,2,13,16,3,4,17]))},{path:"projects",name:"Projects",component:()=>i(()=>import("./Projects-Dz58Xe6b.js"),__vite__mapDeps([18,1,2,16,13,3,4,19]))},{path:"tasks",name:"Tasks",component:()=>i(()=>import("./Tasks-D59GKoh6.js"),__vite__mapDeps([20,1,2,16,3,4,21]))},{path:"projects/:id",name:"ProjectDetail",component:()=>i(()=>import("./ProjectDetail-CFvfz42m.js"),__vite__mapDeps([22,1,2,16,13,3,4,23]))},{path:"accept-invitation",name:"AcceptInvitation",component:()=>i(()=>import("./AcceptInvitation-DK0dCCUz.js"),__vite__mapDeps([24,1,16,3,4,2,25]))},{path:"accept-organization-invitation",name:"AcceptOrganizationInvitation",component:()=>i(()=>import("./AcceptOrganizationInvitation-DuvaM_yT.js"),__vite__mapDeps([26,1,13,3,4,2,27]))},{path:"profile",name:"Profile",component:()=>i(()=>import("./Profile-BUuvU0yd.js"),__vite__mapDeps([28,2,1,3,4,29]))}]}]});f.beforeEach(async(t,r,a)=>{const n=m();n.user===null&&t.meta.requiresAuth&&await n.initializeAuth(),t.meta.requiresAuth&&!n.user?a({path:"/login",query:{redirect:t.fullPath}}):(t.name==="Login"||t.name==="Register")&&n.user?a("/dashboard"):a()});const _=w(C),N=L();_.use(N);_.use(f);_.use(b);const B=m();B.initializeAuth();_.mount("#app");export{c as s,m as u};
