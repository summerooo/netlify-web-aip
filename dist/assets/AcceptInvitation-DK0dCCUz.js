import{y as j,r as s,h as C,aC as B,z as n,A as r,B as t,P as a,O as g,aB as x}from"./vendor-D5A_PLSQ.js";import{m as N,n as A}from"./projects-C6oOc8Q2.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-1yu-MD6X.js";import"./supabase-C1h6x9Gt.js";import"./ui-DUo8Dfqk.js";const E={class:"accept-invitation-container"},P={class:"invitation-card"},T={key:0,class:"loading-state"},q={key:1,class:"error-state"},w={key:2,class:"success-state"},M={key:3,class:"invitation-details"},R={class:"action-buttons"},V=["disabled"],z=["disabled"],O=j({__name:"AcceptInvitation",setup(S){const m=B(),_=x(),u=s(!0),l=s(!1),f=s(!1),i=s(!1),c=s(""),v=s(""),d=s(""),p=s("加载中..."),y=s(""),b=s("成员");C(async()=>{if(v.value=m.query.token,d.value=m.query.projectId,!v.value||!d.value){i.value=!0,c.value="无效的邀请链接，缺少必要参数",u.value=!1;return}try{const o=await N(v.value);p.value=o.projectName,y.value=o.inviterEmail,b.value=o.role||"成员",u.value=!1}catch(o){console.error("获取邀请详情失败:",o),i.value=!0,c.value="无法验证邀请信息，可能已过期或无效",u.value=!1}});const h=async()=>{l.value=!0;try{await A(v.value,d.value),f.value=!0}catch(o){console.error("接受邀请失败:",o),i.value=!0,c.value="接受邀请失败，请稍后再试"}finally{l.value=!1}},I=()=>{_.push(`/projects/${d.value}`)},k=()=>{_.push("/dashboard")};return(o,e)=>(r(),n("div",E,[t("div",P,[u.value?(r(),n("div",T,[...e[0]||(e[0]=[t("div",{class:"spinner"},null,-1),t("p",null,"正在验证邀请...",-1)])])):i.value?(r(),n("div",q,[e[1]||(e[1]=t("h2",null,"邀请验证失败",-1)),t("p",null,a(c.value),1),t("button",{onClick:k,class:"primary-button"},"返回首页")])):f.value?(r(),n("div",w,[e[3]||(e[3]=t("h2",null,"邀请已接受",-1)),t("p",null,[e[2]||(e[2]=g("您已成功加入项目 ",-1)),t("strong",null,a(p.value),1)]),t("button",{onClick:I,class:"primary-button"},"查看项目")])):(r(),n("div",M,[e[5]||(e[5]=t("h2",null,"项目邀请",-1)),t("p",null,[e[4]||(e[4]=g("您被邀请加入项目 ",-1)),t("strong",null,a(p.value),1)]),t("p",null,"邀请人: "+a(y.value),1),t("p",null,"您的角色: "+a(b.value),1),t("div",R,[t("button",{onClick:h,class:"primary-button",disabled:l.value},a(l.value?"处理中...":"接受邀请"),9,V),t("button",{onClick:k,class:"secondary-button",disabled:l.value},"拒绝",8,z)])]))])]))}}),L=D(O,[["__scopeId","data-v-1645edbe"]]);export{L as default};
